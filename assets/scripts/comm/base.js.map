{"version":3,"sources":["scripts/comm/ajaxfix.js","scripts/comm/flexible.js"],"names":["a","define","amd","exports","_typeof","module","require","jQuery","$","support","cors","ajaxTransport","window","XDomainRequest","n","o","p","RegExp","location","protocol","j","k","l","crossDomain","async","test","type","url","m","send","f","g","h","i","dataType","toLowerCase","timeout","ontimeout","onload","responseText","length","contentType","b","code","message","c","text","html","json","parseJSON","e","d","ActiveXObject","loadXML","undefined","documentElement","getElementsByTagName","xml","parseMessage","onprogress","onerror","data","param","open","abort","win","lib","tid","doc","document","docEl","metaEl","querySelector","flexibleEl","dpr","scale","flexible","match","getAttribute","parseFloat","parseInt","content","initialDpr","maximumDpr","toFixed","navigator","appVersion","isIPhone","devicePixelRatio","setAttribute","createElement","firstElementChild","appendChild","wrap","write","innerHTML","refreshRem","width","getBoundingClientRect","rem","style","fontSize","addEventListener","clearTimeout","setTimeout","persisted","readyState","body","rem2px","val","this","px2rem"],"mappings":"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","file":"base.js","sourcesContent":["/*!\r\n * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05\r\n * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest\r\n * Copyright (c) 2015 Jason Moon (@JSONMOON)\r\n * Licensed MIT (/blob/master/LICENSE.txt)\r\n */\r\n;(function (a) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(['jquery'], a)\r\n  } else if (typeof exports === 'object') {\r\n    module.exports = a(require('jquery'))\r\n  } else {\r\n    a(jQuery)\r\n  }\r\n}(function ($) {\r\n  if ($.support.cors || !$.ajaxTransport || !window.XDomainRequest) {\r\n    return $\r\n  }\r\n  var n = /^(https?:)?\\/\\//i;\r\n  var o = /^get|post$/i;\r\n  var p = new RegExp('^(\\/\\/|' + location.protocol + ')', 'i');\r\n  $.ajaxTransport('* text html xml json', function (j, k, l) {\r\n    if (!j.crossDomain || !j.async || !o.test(j.type) || !n.test(j.url) || !p.test(j.url)) {\r\n      return\r\n    }\r\n    var m = null;\r\n    return {\r\n      send: function (f, g) {\r\n        var h = '';\r\n        var i = (k.dataType || '').toLowerCase();\r\n        m = new XDomainRequest();\r\n        if (/^\\d+$/.test(k.timeout)) {\r\n          m.timeout = k.timeout\r\n        }\r\n        m.ontimeout = function () {\r\n          g(500, 'timeout')\r\n        };\r\n        m.onload = function () {\r\n          var a = 'Content-Length: ' + m.responseText.length + '\\r\\nContent-Type: ' + m.contentType;\r\n          var b = {\r\n            code: 200,\r\n            message: 'success'\r\n          };\r\n          var c = {\r\n            text: m.responseText\r\n          };\r\n          try {\r\n            if (i === 'html' || /text\\/html/i.test(m.contentType)) {\r\n              c.html = m.responseText\r\n            } else if (i === 'json' || (i !== 'text' && /\\/json/i.test(m.contentType))) {\r\n              try {\r\n                c.json = $.parseJSON(m.responseText)\r\n              } catch (e) {\r\n                b.code = 500;\r\n                b.message = 'parseerror'\r\n              }\r\n            } else if (i === 'xml' || (i !== 'text' && /\\/xml/i.test(m.contentType))) {\r\n              var d = new ActiveXObject('Microsoft.XMLDOM');\r\n              d.async = false;\r\n              try {\r\n                d.loadXML(m.responseText)\r\n              } catch (e) {\r\n                d = undefined\r\n              }\r\n              if (!d || !d.documentElement || d.getElementsByTagName('parsererror').length) {\r\n                b.code = 500;\r\n                b.message = 'parseerror';\r\n                throw 'Invalid XML: ' + m.responseText;\r\n              }\r\n              c.xml = d\r\n            }\r\n          } catch (parseMessage) {\r\n            throw parseMessage;\r\n          } finally {\r\n            g(b.code, b.message, c, a)\r\n          }\r\n        };\r\n        m.onprogress = function () {};\r\n        m.onerror = function () {\r\n          g(500, 'error', {\r\n            text: m.responseText\r\n          })\r\n        };\r\n        if (k.data) {\r\n          h = ($.type(k.data) === 'string') ? k.data : $.param(k.data)\r\n        }\r\n        m.open(j.type, j.url);\r\n        m.send(h)\r\n      },\r\n      abort: function () {\r\n        if (m) {\r\n          m.abort()\r\n        }\r\n      }\r\n    }\r\n  });\r\n  return $\r\n}));",";(function(win, lib) {\r\n  var doc = win.document;\r\n  var docEl = doc.documentElement;\r\n  var metaEl = doc.querySelector('meta[name=\"viewport\"]');\r\n  var flexibleEl = doc.querySelector('meta[name=\"flexible\"]');\r\n  var dpr = 0;\r\n  var scale = 0;\r\n  var tid;\r\n  var flexible = lib.flexible || (lib.flexible = {});\r\n  \r\n  if (metaEl) {\r\n    //   console.warn('将根据已有的meta标签来设置缩放比例');\r\n      var match = metaEl.getAttribute('content').match(/initial\\-scale=([\\d\\.]+)/);\r\n      if (match) {\r\n          scale = parseFloat(match[1]);\r\n          dpr = parseInt(1 / scale);\r\n      }\r\n  } else if (flexibleEl) {\r\n      var content = flexibleEl.getAttribute('content');\r\n      if (content) {\r\n          var initialDpr = content.match(/initial\\-dpr=([\\d\\.]+)/);\r\n          var maximumDpr = content.match(/maximum\\-dpr=([\\d\\.]+)/);\r\n          if (initialDpr) {\r\n              dpr = parseFloat(initialDpr[1]);\r\n              scale = parseFloat((1 / dpr).toFixed(2));    \r\n          }\r\n          if (maximumDpr) {\r\n              dpr = parseFloat(maximumDpr[1]);\r\n              scale = parseFloat((1 / dpr).toFixed(2));    \r\n          }\r\n      }\r\n  }\r\n\r\n  if (!dpr && !scale) {\r\n      var isAndroid = win.navigator.appVersion.match(/android/gi);\r\n      var isIPhone = win.navigator.appVersion.match(/iphone/gi);\r\n      var devicePixelRatio = win.devicePixelRatio;\r\n      if (isIPhone) {\r\n          // iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案\r\n          if (devicePixelRatio >= 3 && (!dpr || dpr >= 3)) {                \r\n              dpr = 3;\r\n          } else if (devicePixelRatio >= 2 && (!dpr || dpr >= 2)){\r\n              dpr = 2;\r\n          } else {\r\n              dpr = 1;\r\n          }\r\n      } else {\r\n          // 其他设备下，仍旧使用1倍的方案\r\n          dpr = 1;\r\n      }\r\n      scale = 1 / dpr;\r\n  }\r\n\r\n  docEl.setAttribute('data-dpr', dpr);\r\n  if (!metaEl) {\r\n      metaEl = doc.createElement('meta');\r\n      metaEl.setAttribute('name', 'viewport');\r\n      metaEl.setAttribute('content', 'initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\r\n      if (docEl.firstElementChild) {\r\n          docEl.firstElementChild.appendChild(metaEl);\r\n      } else {\r\n          var wrap = doc.createElement('div');\r\n          wrap.appendChild(metaEl);\r\n          doc.write(wrap.innerHTML);\r\n      }\r\n  }\r\n\r\n  function refreshRem(){\r\n      var width = docEl.getBoundingClientRect().width;\r\n      if (width / dpr > 540) {\r\n          width = 540 * dpr;\r\n      }\r\n      var rem = width / 10;\r\n      docEl.style.fontSize = rem + 'px';\r\n      flexible.rem = win.rem = rem;\r\n  }\r\n\r\n  win.addEventListener('resize', function() {\r\n      clearTimeout(tid);\r\n      tid = setTimeout(refreshRem, 300);\r\n  }, false);\r\n  win.addEventListener('pageshow', function(e) {\r\n      if (e.persisted) {\r\n          clearTimeout(tid);\r\n          tid = setTimeout(refreshRem, 300);\r\n      }\r\n  }, false);\r\n\r\n  if (doc.readyState === 'complete') {\r\n      doc.body.style.fontSize = 12 * dpr + 'px';\r\n  } else {\r\n      doc.addEventListener('DOMContentLoaded', function(e) {\r\n          doc.body.style.fontSize = 12 * dpr + 'px';\r\n      }, false);\r\n  }\r\n  \r\n\r\n  refreshRem();\r\n\r\n  flexible.dpr = win.dpr = dpr;\r\n  flexible.refreshRem = refreshRem;\r\n  flexible.rem2px = function(d) {\r\n      var val = parseFloat(d) * this.rem;\r\n      if (typeof d === 'string' && d.match(/rem$/)) {\r\n          val += 'px';\r\n      }\r\n      return val;\r\n  }\r\n  flexible.px2rem = function(d) {\r\n      var val = parseFloat(d) / this.rem;\r\n      if (typeof d === 'string' && d.match(/px$/)) {\r\n          val += 'rem';\r\n      }\r\n      return val;\r\n  }\r\n\r\n})(window, window['lib'] || (window['lib'] = {}));"]}
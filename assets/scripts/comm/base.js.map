{"version":3,"sources":["scripts/index.js"],"names":["$","dom","fullpage","css3","anchors","menu","afterLoad","anchorLink","index","hasClass","setTimeout","addClass","find","each","i","v","this","prop","animate","Counter","text","duration","easing","step","now","x","f","parseFloat","isNaN","s","Math","round","toString","rs","indexOf","length","toDecimal","ceil","toChange","onLeave","direction","on","left","eq","siblings","removeClass","ajax","url","type","dataType","data","done","res","count","page","results","forEach","a","summary","image_url","title","substr","created_time","id","html","window","width","container","document","getElementById","ul","querySelector","lis","querySelectorAll","liWidth","offsetWidth","cloneLi","cloneNode","appendChild","call","style","setInterval","marginLeft","css","carousel","parentNode","height","mouseenter","thisPX","offset","thisPY","top","boxWidth","outerWidth","boxHeight","outerHeight","mousemove","event","X","Y","mouseX","pageX","mouseY","pageY","transform","mouseleave","timer","clearTimeout"],"mappings":"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","file":"base.js","sourcesContent":["$(function () {\r\n  $('#fullpage').fullpage({\r\n    css3: true,\r\n    anchors: ['homepage', 'energysave', 'innovation', 'partner', 'news'],\r\n    menu: \".menu\",\r\n    afterLoad: function (anchorLink, index) {\r\n      //首屏幕的动画\r\n      if (!$('.homepage').hasClass('on')) {\r\n        setTimeout(function () {\r\n          $('.homepage').addClass('on')\r\n        }, 2000)\r\n      }\r\n      toChange(index)\r\n    },\r\n    onLeave: function (index, direction) {\r\n      // console.log('离开', index, direction)\r\n    }\r\n  });\r\n\r\n  function toDecimal(x) {\r\n    var f = parseFloat(x);\r\n    if (isNaN(f)) {\r\n      return false;\r\n    }\r\n    var f = Math.round(x * 10) / 10;\r\n    var s = f.toString();\r\n    var rs = s.indexOf('.');\r\n    if (rs < 0) {\r\n      rs = s.length;\r\n    }\r\n    return s;\r\n  }\r\n  //每屏首次加载后执行的函数\r\n  function toChange(index) {\r\n    switch (index) {\r\n      case 2:\r\n        if (!$('.energysave').hasClass('on')) {\r\n          $('.energysave')\r\n            .addClass('on')\r\n            .find('li b').each(function (i, v) {\r\n              $(this).prop('Counter', 0).animate({\r\n                Counter: $(this).text()\r\n              }, {\r\n                duration: 2000,\r\n                easing: 'swing',\r\n                step: i == 2 ? function (now) {\r\n                  $(this).text(toDecimal(now));\r\n                } : function (now) {\r\n                  $(this).text(Math.ceil(now));\r\n                }\r\n              });\r\n            });\r\n        }\r\n        break;\r\n      case 3:\r\n        if (!$('.innovation').hasClass('on')) {\r\n          $('.innovation').addClass('on')\r\n        }\r\n        break;\r\n      case 4:\r\n        if (!$('.partner').hasClass('on')) {\r\n          $('.partner').addClass('on')\r\n        }\r\n        break;\r\n      case 5:\r\n        if (!$('.news').hasClass('on')) {\r\n          $('.news').addClass('on')\r\n        }\r\n        break;\r\n    }\r\n  }\r\n  //创新科技四个气泡框选择\r\n  $('#fourbubble').on('click', 'li', function () {\r\n    var index = $(this).index()\r\n    $('#fourcontent span').animate({\r\n      'left': 12.5 + 25 * index + '%'\r\n    }, 100)\r\n    $('#fourcontent p').eq(index).addClass('on').siblings('p').removeClass('on')\r\n  })\r\n  //新闻列表,设置轮播\r\n  function getnews() {\r\n    $.ajax({\r\n      url: 'http://test.oms.hwariot.com/api/v1/news/?page_size=4',\r\n      type: 'GET',\r\n      dataType: \"json\",\r\n      data: {},\r\n    }).done(res => {\r\n      if (res.count > 0) {\r\n        var page = '';\r\n        res.results.forEach((v, i) => {\r\n          var a = v.summary.length > 40 ? \"...\" : \"\";\r\n          page += `\r\n          <li>\r\n            <div class=\"imgbox\">\r\n              <div>\r\n                <img src=\"${v.image_url}\">\r\n              </div>\r\n            </div>\r\n            <h3>${v.title}</h3>\r\n            <p>${v.summary.substr(0, 40)+a}</p>\r\n            <div>\r\n              <span class=\"date\">${v.created_time}</span>\r\n              <a href=\"/@/newsdetail.html?id=${v.id}\">详情 >></a>\r\n            </div>\r\n          </li>`\r\n        })\r\n        $('#newslist ul').html(page)\r\n        \r\n      }\r\n    }).done(res=>{\r\n      if($(window).width()>768){\r\n        carousel()        \r\n      }\r\n      clipimg()\r\n    })\r\n  }\r\n  getnews()\r\n\r\n  //新闻列表轮播图\r\n  function carousel() {\r\n    var container = document.getElementById('newslist')\r\n    var ul = container.querySelector('ul');\r\n    var lis = ul.querySelectorAll('li');\r\n    var timer = null;\r\n    var index = 1;\r\n    var containerWidth = container.offsetWidth;\r\n    var liWidth = lis[0].offsetWidth;\r\n\r\n    for (var i = 0; i < 2; i++) {\r\n      var cloneLi = lis[i].cloneNode(true);\r\n      ul.appendChild(cloneLi)\r\n    }\r\n\r\n    function setUlWidth() {\r\n      [].forEach.call(ul.querySelectorAll('li'), function (v, i) {\r\n        v.style.width = liWidth + 'px';\r\n        ul.style.width = liWidth * 6 + 'px' //这里可以优化下性能，不过不是重点\r\n      })\r\n    }\r\n    setUlWidth();\r\n\r\n    timer = setInterval(function () {\r\n      $(ul).animate({\r\n        'marginLeft': -liWidth * index++\r\n      }, 500)\r\n      if (index === 5) {\r\n        $(ul).css({\r\n          'marginLeft': 0\r\n        })\r\n        index = 1\r\n      }\r\n    }, 8000)\r\n  }\r\n  //裁剪图片\r\n  function clipimg(){\r\n    $('#newslist img').each(function(i,v){\r\n      $(v.parentNode).css({'height': $(v).width()*0.66})\r\n    })\r\n  }\r\n\r\n  //图片微交互\r\n  function shakeAnimation(dom) {\r\n    $(dom).mouseenter(function () {\r\n      var thisPX = $(this).offset().left;\r\n      var thisPY = $(this).offset().top;\r\n      var boxWidth = $(this).outerWidth();\r\n      var boxHeight = $(this).outerHeight();\r\n      $(this).mousemove(function (event) {\r\n        var mouseX = event.pageX - thisPX;\r\n        var mouseY = event.pageY - thisPY;\r\n        var X;\r\n        var Y;\r\n        if (mouseX > boxWidth / 2) {\r\n          X = mouseX - boxWidth / 2;\r\n        } else {\r\n          X = mouseX - boxWidth / 2;\r\n        }\r\n        if (mouseY > boxHeight / 2) {\r\n          Y = boxHeight / 2 - mouseY;\r\n        } else {\r\n          Y = boxHeight / 2 - mouseY;\r\n        }\r\n\r\n        $(this).find('img').each((i, v) => {\r\n          var s = i % 2 === 0 ? (10 + 10 * i) : (10 + 10 * i)\r\n          $(v).css({\r\n            \"transform\": \"translateY(\" + X / s + \"px) \" + \"translateX(\" + Y / s + \"px) \"\r\n          })\r\n        })\r\n      });\r\n    });\r\n    $(dom).mouseleave(function () {\r\n      $(this).css({\r\n        // \"transform\": \"rotateY(0deg) rotateX(0deg)\"\r\n      });\r\n    });\r\n  }\r\n  shakeAnimation('aside')\r\n\r\n\r\n  //resize\r\n  var timer = null;\r\n  $(window).on('resize',function(){\r\n    clearTimeout(timer)\r\n    timer = setTimeout(function(){\r\n      // location.reload()\r\n    },300)\r\n    \r\n  })\r\n})"]}
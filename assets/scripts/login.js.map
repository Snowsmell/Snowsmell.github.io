{"version":3,"sources":["scripts/login.js"],"names":["$","url","obj","request","_ref","data","type","token","CookieUtil","get","ajax","contentType","beforeSend","res","setRequestHeader","dataType","console","log","SERVER","window","location","href","search","replace","rs","$1","$2","val","decodeURIComponent","String","target","addClass","siblings","removeClass","dom","inputCheck","usernameDom","psdDom","username","trim","psd","html","a","test","b","c","phoneDom","codeDom","phone","code","clearErrmsg","setToken","time","Date","setUserData","sendSMS","phone_number","done","ele","timer","setInterval","clearInterval","stopsend","switchStep","source","userlogin","config","password","fail","err","userRegist","role","filter","phoneBind","number","verify_code","serial_number","resetPsd","config2","sms_type","this","father","parents","find","mouseenter","thisPX","offset","left","boxWidth","outerWidth","boxHeight","outerHeight","mousemove","event","X","Y","mouseX","pageX","mouseY","pageY","thisPY","each","i","v","s","css","transform","mouseleave","shakeAnimation"],"mappings":"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","file":"login.js","sourcesContent":["$(function () {\r\n\r\n  const SERVER = 'api未定'\r\n  console.log(SERVER)\r\n\r\n  \r\n  var params = getQueryObject();\r\n  if (params.target === 'reg') {\r\n    $('.chooseRole').addClass('on').siblings('div').removeClass('on')\r\n  }\r\n\r\n  //查询url参数\r\n  function getQueryObject(url) {\r\n    url = url == null ? window.location.href : url\r\n    const search = url.substring(url.lastIndexOf('?') + 1)\r\n    const obj = {}\r\n    const reg = /([^?&=]+)=([^?&=]*)/g\r\n    search.replace(reg, (rs, $1, $2) => {\r\n      const name = decodeURIComponent($1)\r\n      let val = decodeURIComponent($2)\r\n      val = String(val)\r\n      obj[name] = val\r\n      return rs\r\n    })\r\n    return obj\r\n  }\r\n\r\n  /**\r\n   * ajax请求\r\n   * @param {String} url 请求地址\r\n   * @param {Object} data 参数\r\n   * @param {String} type 类型\r\n   */\r\n  function request({\r\n    url,\r\n    data,\r\n    type\r\n  }) {\r\n    var token = getToken()\r\n    return $.ajax({\r\n      url: url,\r\n      type: type,\r\n      data: JSON.stringify(data),\r\n      contentType: \"application/json;charset=utf-8\",\r\n      beforeSend: res => {\r\n        if (token) {\r\n          res.setRequestHeader(\"Authorization\", token);\r\n        }\r\n      },\r\n      dataType: 'json'\r\n    })\r\n  }\r\n\r\n  //输入检查\r\n  var inputCheck = {\r\n    //登录前检查 若验证通过，返回username,psd\r\n    'loginCheck': function (usernameDom, psdDom) {\r\n      let username = $.trim($(usernameDom).val())\r\n      let psd = $(psdDom).val()\r\n      if (!username) {\r\n        $(usernameDom).siblings('.errmsg').html('用户名不能为空')\r\n      }\r\n      if (!psd) {\r\n        $(psdDom).siblings('.errmsg').html('密码不能为空')\r\n      }\r\n      if (!username || !psd) {\r\n        return false\r\n      } else {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      }\r\n    },\r\n    //注册前检查 若验证通过，返回username,psd\r\n    'regCheck': function () {\r\n      var username = $('#regUserName').val()\r\n      var psd = $('#regPsd').val()\r\n      var namecheck = /^[a-zA-Z0-9_-]{4,16}$/\r\n      var psdcheck = /^.*(?=.{6,})(?=.*\\d)(?=.*[a-z]).*$/\r\n      var a = namecheck.test($.trim(username))\r\n      var b = psdcheck.test(psd)\r\n      var c = psd === $('#confirmPsd').val()\r\n      if (!a) {\r\n        $('#regnameErr').html('由4-16位大小写字母，数字，下划线组合')\r\n      }\r\n      if (!b) {\r\n        $('#regpsdErr').html('请输入大于6位，且同时包含字母和数字')\r\n      }\r\n      if (!c) {\r\n        $('#regconfirmpsdErr').html('两次密码不一致')\r\n      }\r\n      if (a && b && c) {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n    //绑定手机检查 若验证通过，参数分别是手机号dom和验证码dom，返回phone,code\r\n    'smsCheck': function (phoneDom, codeDom) {\r\n      var phone = $(phoneDom).val()\r\n      var code = $(codeDom).val()\r\n      var a = /^1[34578]\\d{9}$/.test(phone)\r\n      var b = /^\\d{4}$/.test(code)\r\n      if (!a) {\r\n        $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      }\r\n      if (!b) {\r\n        $(codeDom).siblings('.errmsg').html('验证码格式不正确')\r\n      }\r\n      if (a && b) {\r\n        return {\r\n          phone,\r\n          code\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  //清除错误信息\r\n  function clearErrmsg() {\r\n    $('.errmsg').html('')\r\n  }\r\n\r\n  //设置token\r\n  function setToken(token) {\r\n    var time = new Date()\r\n    time.setTime(time.getTime() + 60 * 1000)\r\n    CookieUtil.set('hwUserToken', token, time)\r\n    // window.sessionStorage.setItem('hwUserToken', token)\r\n  }\r\n  //获取token\r\n  function getToken() {\r\n    return CookieUtil.get('hwUserToken')\r\n    // return window.sessionStorage.getItem('hwUserToken')\r\n  }\r\n\r\n  //设置用户基本信息userid,username,avatar,roletype\r\n  function setUserData(res) {\r\n    // window.sessionStorage.setItem('hwUserId', res.id)\r\n    // window.sessionStorage.setItem('hwUserName', res.name)    \r\n    // window.sessionStorage.setItem('hwUserAvatar', res.avatar)\r\n    // window.sessionStorage.setItem('hwuserRole', JSON.stringify(res.role))\r\n    CookieUtil.set('hwUserData', JSON.stringify(res))\r\n  }\r\n\r\n  //发送验证码等待时间\r\n  function stopsend(ele) {\r\n    $(ele).attr('disabled', \"true\")\r\n    var time = 60\r\n    var timer = setInterval(function () {\r\n      if (time-- == 1) {\r\n        $(ele).removeAttr(\"disabled\")\r\n        clearInterval(timer)\r\n      }\r\n      $(ele).html(time == 0 ? '获取验证码' : time + 's')\r\n    }, 1000)\r\n  }\r\n\r\n  //登录\r\n  function userlogin() {\r\n    clearErrmsg()\r\n    let config = inputCheck.loginCheck('#loginUserName', '#loginPsd')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/login/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          type: 2\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#loginErr').html(res.message)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          // location.href=\"/@/index.html\";\r\n        }\r\n      }).fail(function (err) {\r\n        console.log(err)\r\n      })\r\n    }\r\n  }\r\n  //注册\r\n  function userRegist() {\r\n    clearErrmsg()\r\n    var config = inputCheck.regCheck()\r\n    var role = $(\"[name='userrole']\").filter(\":checked\").val()\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/register/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          role: parseInt(role)\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        $('#regErr').html(res.message)\r\n        console.log(res)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          $('.bindPhone').addClass('on').siblings('div').removeClass('on')\r\n        }\r\n      })\r\n    }\r\n  }\r\n  //发送验证码\r\n  function sendSMS(phoneDom, type, dom) {\r\n    clearErrmsg()\r\n    var phone = $(phoneDom).val()\r\n    var a = /^1[34578]\\d{9}$/.test(phone)\r\n    if (!a) {\r\n      $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      return\r\n    } else {\r\n      request({\r\n        url: `${SERVER}/users/sms/`,\r\n        data: {\r\n          phone_number: phone,\r\n          type\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        stopsend(dom)\r\n        dom.data('serialNumber', res.data.serial_number)\r\n      })\r\n    }\r\n  }\r\n  //手机绑定\r\n  function phoneBind() {\r\n    clearErrmsg()\r\n    var number = $('#sendBindMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#bindphoneNum', '#verifyCode')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/phone/binding/`,\r\n        data: {\r\n          phone_number: config.phone,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          type: 6\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#bindmsg').html(res.message)\r\n      })\r\n    }\r\n  }\r\n  //密码重置\r\n  function resetPsd() {\r\n    clearErrmsg()\r\n    var number = $('#sendResetPsdMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode')\r\n    var config2 = inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')\r\n    if (config && config2) {\r\n      request({\r\n        url: `${SERVER}/users/password/`,\r\n        data: {\r\n          username: config2.username,\r\n          password: config2.psd,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          sms_type: 4,\r\n        },\r\n        type: 'put'\r\n      }).done(res => {\r\n        console.log(1, res)\r\n      })\r\n    }\r\n  }\r\n  //登录注册找回密码，步骤切换\r\n  function switchStep(source, target) {\r\n    $(source).on('click', function () {\r\n      $(target).addClass('on').siblings('div').removeClass('on')\r\n    })\r\n  }\r\n\r\n  switchStep('#toRegister', '.chooseRole')\r\n  switchStep('#tologin', '.loginForm')\r\n  switchStep('.chooseRole label', '.userRegister')\r\n  switchStep('#forgetpsd a', '.resetpsd')\r\n\r\n\r\n  $('#loginbtn').on('click', function () {\r\n    userlogin()\r\n  })\r\n  $('#nextstep').on('click', function () {\r\n    userRegist()\r\n  })\r\n  $('#complete').on('click', function () {\r\n    phoneBind()\r\n  })\r\n  $('#resetPsd').on('click', function () {\r\n    resetPsd()\r\n  })\r\n  $('#sendBindMsg').on('click', function () {\r\n    sendSMS('#bindphoneNum', 6, $(this))\r\n  })\r\n  $('#sendResetPsdMsg').on('click', function () {\r\n    sendSMS('#resetPsdPhone', 4, $(this))\r\n  })\r\n\r\n  //登录时暂时没啥用的切换\r\n  $('.loginForm>div').on('click', 'span', function () {\r\n    $(this).addClass('on').siblings().removeClass('on')\r\n  })\r\n\r\n  //按钮置灰\r\n  $('.form-item').on('keyup', 'input', function () {\r\n    clearErrmsg()\r\n    var father = $(this).parents('.form-item')\r\n    var type = father.data('type')\r\n    switch (type) {\r\n      case 'loginForm':\r\n        if (inputCheck['loginCheck']('#loginUserName', '#loginPsd')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break\r\n      case 'userRegister':\r\n        if (inputCheck['regCheck']()) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n      case 'bindPhone':\r\n        if (inputCheck['smsCheck']('#bindphoneNum', '#verifyCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n      case 'resetpsd':\r\n        if (inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode') && inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        return;\r\n    }\r\n\r\n\r\n  })\r\n  //图片微交互\r\n  function shakeAnimation(dom) {\r\n    $(dom).mouseenter(function () {\r\n      var thisPX = $(this).offset().left;\r\n      var thisPY = $(this).offset().top;\r\n      var boxWidth = $(this).outerWidth();\r\n      var boxHeight = $(this).outerHeight();\r\n      $(this).mousemove(function (event) {\r\n        var mouseX = event.pageX - thisPX;\r\n        var mouseY = event.pageY - thisPY;\r\n        var X;\r\n        var Y;\r\n        if (mouseX > boxWidth / 2) {\r\n          X = mouseX - boxWidth / 2;\r\n        } else {\r\n          X = mouseX - boxWidth / 2;\r\n        }\r\n        if (mouseY > boxHeight / 2) {\r\n          Y = boxHeight / 2 - mouseY;\r\n        } else {\r\n          Y = boxHeight / 2 - mouseY;\r\n        }\r\n\r\n        $(this).find('img').each((i, v) => {\r\n          var s = i % 2 === 0 ? (10 + 10 * i) : (10 + 10 * i)\r\n          $(v).css({\r\n            \"transform\": \"translateY(\" + X / s + \"px) \" + \"translateX(\" + Y / s + \"px) \"\r\n          })\r\n        })\r\n\r\n        // $(this).css({\r\n        //   \"transform\": \"translateY(\"+X/20+\"px) \" +\"translateX(\"+Y/20+\"px) \"\r\n        // });\r\n\r\n      });\r\n    });\r\n    $(dom).mouseleave(function () {\r\n      $(this).css({\r\n        \"transform\": \"rotateY(0deg) rotateX(0deg)\"\r\n      });\r\n    });\r\n  }\r\n  shakeAnimation('.imgbox')\r\n})"]}
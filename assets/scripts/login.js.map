{"version":3,"sources":["scripts/login.js"],"names":["$","SERVER","console","log","params","getQueryObject","target","addClass","siblings","removeClass","url","window","location","href","search","substring","lastIndexOf","obj","reg","replace","rs","$1","$2","name","decodeURIComponent","val","String","request","data","type","token","getToken","ajax","JSON","stringify","contentType","beforeSend","res","setRequestHeader","dataType","inputCheck","usernameDom","psdDom","username","trim","psd","html","namecheck","psdcheck","a","test","b","c","phoneDom","codeDom","phone","code","clearErrmsg","setToken","time","Date","setTime","getTime","CookieUtil","set","get","setUserData","stopsend","ele","attr","timer","setInterval","removeAttr","clearInterval","userlogin","config","loginCheck","password","done","message","fail","err","userRegist","regCheck","role","filter","parseInt","sendSMS","dom","phone_number","serial_number","phoneBind","number","smsCheck","verify_code","resetPsd","config2","sms_type","switchStep","source","on","father","parents","find","shakeAnimation","mouseenter","thisPX","offset","left","thisPY","top","boxWidth","outerWidth","boxHeight","outerHeight","mousemove","event","mouseX","pageX","mouseY","pageY","X","Y","each","i","v","s","css","mouseleave"],"mappings":"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","file":"login.js","sourcesContent":["$(function () {\r\n\r\n  const SERVER = '/user-service/api/v1'\r\n  console.log(SERVER)\r\n\r\n  \r\n  var params = getQueryObject();\r\n  if (params.target === 'reg') {\r\n    $('.chooseRole').addClass('on').siblings('div').removeClass('on')\r\n  }\r\n\r\n  //查询url参数\r\n  function getQueryObject(url) {\r\n    url = url == null ? window.location.href : url\r\n    const search = url.substring(url.lastIndexOf('?') + 1)\r\n    const obj = {}\r\n    const reg = /([^?&=]+)=([^?&=]*)/g\r\n    search.replace(reg, (rs, $1, $2) => {\r\n      const name = decodeURIComponent($1)\r\n      let val = decodeURIComponent($2)\r\n      val = String(val)\r\n      obj[name] = val\r\n      return rs\r\n    })\r\n    return obj\r\n  }\r\n\r\n  /**\r\n   * ajax请求\r\n   * @param {String} url 请求地址\r\n   * @param {Object} data 参数\r\n   * @param {String} type 类型\r\n   */\r\n  function request({\r\n    url,\r\n    data,\r\n    type\r\n  }) {\r\n    var token = getToken()\r\n    return $.ajax({\r\n      url: url,\r\n      type: type,\r\n      data: JSON.stringify(data),\r\n      contentType: \"application/json;charset=utf-8\",\r\n      beforeSend: res => {\r\n        if (token) {\r\n          res.setRequestHeader(\"Authorization\", token);\r\n        }\r\n      },\r\n      dataType: 'json'\r\n    })\r\n  }\r\n\r\n  //输入检查\r\n  var inputCheck = {\r\n    //登录前检查 若验证通过，返回username,psd\r\n    'loginCheck': function (usernameDom, psdDom) {\r\n      let username = $.trim($(usernameDom).val())\r\n      let psd = $(psdDom).val()\r\n      if (!username) {\r\n        $(usernameDom).siblings('.errmsg').html('用户名不能为空')\r\n      }\r\n      if (!psd) {\r\n        $(psdDom).siblings('.errmsg').html('密码不能为空')\r\n      }\r\n      if (!username || !psd) {\r\n        return false\r\n      } else {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      }\r\n    },\r\n    //注册前检查 若验证通过，返回username,psd\r\n    'regCheck': function () {\r\n      var username = $('#regUserName').val()\r\n      var psd = $('#regPsd').val()\r\n      var namecheck = /^[a-zA-Z0-9_-]{4,16}$/\r\n      var psdcheck = /^.*(?=.{6,})(?=.*\\d)(?=.*[a-z]).*$/\r\n      var a = namecheck.test($.trim(username))\r\n      var b = psdcheck.test(psd)\r\n      var c = psd === $('#confirmPsd').val()\r\n      if (!a) {\r\n        $('#regnameErr').html('由4-16位大小写字母，数字，下划线组合')\r\n      }\r\n      if (!b) {\r\n        $('#regpsdErr').html('请输入大于6位，且同时包含字母和数字')\r\n      }\r\n      if (!c) {\r\n        $('#regconfirmpsdErr').html('两次密码不一致')\r\n      }\r\n      if (a && b && c) {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n    //绑定手机检查 若验证通过，参数分别是手机号dom和验证码dom，返回phone,code\r\n    'smsCheck': function (phoneDom, codeDom) {\r\n      var phone = $(phoneDom).val()\r\n      var code = $(codeDom).val()\r\n      var a = /^1[34578]\\d{9}$/.test(phone)\r\n      var b = /^\\d{4}$/.test(code)\r\n      if (!a) {\r\n        $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      }\r\n      if (!b) {\r\n        $(codeDom).siblings('.errmsg').html('验证码格式不正确')\r\n      }\r\n      if (a && b) {\r\n        return {\r\n          phone,\r\n          code\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  //清除错误信息\r\n  function clearErrmsg() {\r\n    $('.errmsg').html('')\r\n  }\r\n\r\n  //设置token\r\n  function setToken(token) {\r\n    var time = new Date()\r\n    time.setTime(time.getTime() + 60 * 1000)\r\n    CookieUtil.set('hwUserToken', token, time)\r\n    // window.sessionStorage.setItem('hwUserToken', token)\r\n  }\r\n  //获取token\r\n  function getToken() {\r\n    return CookieUtil.get('hwUserToken')\r\n    // return window.sessionStorage.getItem('hwUserToken')\r\n  }\r\n\r\n  //设置用户基本信息userid,username,avatar,roletype\r\n  function setUserData(res) {\r\n    // window.sessionStorage.setItem('hwUserId', res.id)\r\n    // window.sessionStorage.setItem('hwUserName', res.name)    \r\n    // window.sessionStorage.setItem('hwUserAvatar', res.avatar)\r\n    // window.sessionStorage.setItem('hwuserRole', JSON.stringify(res.role))\r\n    CookieUtil.set('hwUserData', JSON.stringify(res))\r\n  }\r\n\r\n  //发送验证码等待时间\r\n  function stopsend(ele) {\r\n    $(ele).attr('disabled', \"true\")\r\n    var time = 60\r\n    var timer = setInterval(function () {\r\n      if (time-- == 1) {\r\n        $(ele).removeAttr(\"disabled\")\r\n        clearInterval(timer)\r\n      }\r\n      $(ele).html(time == 0 ? '获取验证码' : time + 's')\r\n    }, 1000)\r\n  }\r\n\r\n  //登录\r\n  function userlogin() {\r\n    clearErrmsg()\r\n    let config = inputCheck.loginCheck('#loginUserName', '#loginPsd')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/login/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          type: 2\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#loginErr').html(res.message)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          // location.href=\"/@/index.html\";\r\n        }\r\n      }).fail(function (err) {\r\n        console.log(err)\r\n      })\r\n    }\r\n  }\r\n  //注册\r\n  function userRegist() {\r\n    clearErrmsg()\r\n    var config = inputCheck.regCheck()\r\n    var role = $(\"[name='userrole']\").filter(\":checked\").val()\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/register/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          role: parseInt(role)\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        $('#regErr').html(res.message)\r\n        console.log(res)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          $('.bindPhone').addClass('on').siblings('div').removeClass('on')\r\n        }\r\n      })\r\n    }\r\n  }\r\n  //发送验证码\r\n  function sendSMS(phoneDom, type, dom) {\r\n    clearErrmsg()\r\n    var phone = $(phoneDom).val()\r\n    var a = /^1[34578]\\d{9}$/.test(phone)\r\n    if (!a) {\r\n      $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      return\r\n    } else {\r\n      request({\r\n        url: `${SERVER}/users/sms/`,\r\n        data: {\r\n          phone_number: phone,\r\n          type\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        stopsend(dom)\r\n        dom.data('serialNumber', res.data.serial_number)\r\n      })\r\n    }\r\n  }\r\n  //手机绑定\r\n  function phoneBind() {\r\n    clearErrmsg()\r\n    var number = $('#sendBindMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#bindphoneNum', '#verifyCode')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/phone/binding/`,\r\n        data: {\r\n          phone_number: config.phone,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          type: 6\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#bindmsg').html(res.message)\r\n      })\r\n    }\r\n  }\r\n  //密码重置\r\n  function resetPsd() {\r\n    clearErrmsg()\r\n    var number = $('#sendResetPsdMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode')\r\n    var config2 = inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')\r\n    if (config && config2) {\r\n      request({\r\n        url: `${SERVER}/users/password/`,\r\n        data: {\r\n          username: config2.username,\r\n          password: config2.psd,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          sms_type: 4,\r\n        },\r\n        type: 'put'\r\n      }).done(res => {\r\n        console.log(1, res)\r\n      })\r\n    }\r\n  }\r\n  //登录注册找回密码，步骤切换\r\n  function switchStep(source, target) {\r\n    $(source).on('click', function () {\r\n      $(target).addClass('on').siblings('div').removeClass('on')\r\n    })\r\n  }\r\n\r\n  switchStep('#toRegister', '.chooseRole')\r\n  switchStep('#tologin', '.loginForm')\r\n  switchStep('.chooseRole label', '.userRegister')\r\n  switchStep('#forgetpsd a', '.resetpsd')\r\n\r\n\r\n  $('#loginbtn').on('click', function () {\r\n    userlogin()\r\n  })\r\n  $('#nextstep').on('click', function () {\r\n    userRegist()\r\n  })\r\n  $('#complete').on('click', function () {\r\n    phoneBind()\r\n  })\r\n  $('#resetPsd').on('click', function () {\r\n    resetPsd()\r\n  })\r\n  $('#sendBindMsg').on('click', function () {\r\n    sendSMS('#bindphoneNum', 6, $(this))\r\n  })\r\n  $('#sendResetPsdMsg').on('click', function () {\r\n    sendSMS('#resetPsdPhone', 4, $(this))\r\n  })\r\n\r\n  //登录时暂时没啥用的切换\r\n  $('.loginForm>div').on('click', 'span', function () {\r\n    $(this).addClass('on').siblings().removeClass('on')\r\n  })\r\n\r\n  //按钮置灰\r\n  $('.form-item').on('keyup', 'input', function () {\r\n    clearErrmsg()\r\n    var father = $(this).parents('.form-item')\r\n    var type = father.data('type')\r\n    switch (type) {\r\n      case 'loginForm':\r\n        if (inputCheck['loginCheck']('#loginUserName', '#loginPsd')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break\r\n      case 'userRegister':\r\n        if (inputCheck['regCheck']()) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n      case 'bindPhone':\r\n        if (inputCheck['smsCheck']('#bindphoneNum', '#verifyCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n      case 'resetpsd':\r\n        if (inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode') && inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        return;\r\n    }\r\n\r\n\r\n  })\r\n  //图片微交互\r\n  function shakeAnimation(dom) {\r\n    $(dom).mouseenter(function () {\r\n      var thisPX = $(this).offset().left;\r\n      var thisPY = $(this).offset().top;\r\n      var boxWidth = $(this).outerWidth();\r\n      var boxHeight = $(this).outerHeight();\r\n      $(this).mousemove(function (event) {\r\n        var mouseX = event.pageX - thisPX;\r\n        var mouseY = event.pageY - thisPY;\r\n        var X;\r\n        var Y;\r\n        if (mouseX > boxWidth / 2) {\r\n          X = mouseX - boxWidth / 2;\r\n        } else {\r\n          X = mouseX - boxWidth / 2;\r\n        }\r\n        if (mouseY > boxHeight / 2) {\r\n          Y = boxHeight / 2 - mouseY;\r\n        } else {\r\n          Y = boxHeight / 2 - mouseY;\r\n        }\r\n\r\n        $(this).find('img').each((i, v) => {\r\n          var s = i % 2 === 0 ? (10 + 10 * i) : (10 + 10 * i)\r\n          $(v).css({\r\n            \"transform\": \"translateY(\" + X / s + \"px) \" + \"translateX(\" + Y / s + \"px) \"\r\n          })\r\n        })\r\n\r\n        // $(this).css({\r\n        //   \"transform\": \"translateY(\"+X/20+\"px) \" +\"translateX(\"+Y/20+\"px) \"\r\n        // });\r\n\r\n      });\r\n    });\r\n    $(dom).mouseleave(function () {\r\n      $(this).css({\r\n        \"transform\": \"rotateY(0deg) rotateX(0deg)\"\r\n      });\r\n    });\r\n  }\r\n  shakeAnimation('.imgbox')\r\n})"]}
{"version":3,"sources":["scripts/login.js"],"names":["$","url","search","SERVER","request","_ref","data","type","token","CookieUtil","get","ajax","contentType","beforeSend","dataType","window","location","href","substring","lastIndexOf","replace","rs","$1","$2","name","decodeURIComponent","val","String","obj","target","addClass","siblings","removeClass","dom","inputCheck","usernameDom","psdDom","username","trim","psd","html","a","test","b","c","phoneDom","codeDom","phone","code","clearErrmsg","setToken","time","Date","setTime","getTime","setUserData","res","set","JSON","stringify","sendSMS","phone_number","ele","attr","timer","setInterval","removeAttr","stopsend","switchStep","source","on","config","password","console","log","fail","err","userlogin","role","filter","message","userRegist","verify_code","serial_number","phoneBind","config2","resetPsd","father","this","parents","mouseenter","thisPX","offset","left","thisPY","top","boxHeight","outerHeight","mousemove","event","X","mouseX","pageX","mouseY","pageY","Y","s","i","v","css","transform","mouseleave"],"mappings":"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","file":"login.js","sourcesContent":["$(function () {\r\n  const SERVER = '/user-service/api/v1'  \r\n  var params = getQueryObject();\r\n  if (params.target === 'reg') {\r\n    $('.chooseRole').addClass('on').siblings('div').removeClass('on')\r\n  }\r\n\r\n  //查询url参数\r\n  function getQueryObject(url) {\r\n    url = url == null ? window.location.href : url\r\n    const search = url.substring(url.lastIndexOf('?') + 1)\r\n    const obj = {}\r\n    const reg = /([^?&=]+)=([^?&=]*)/g\r\n    search.replace(reg, (rs, $1, $2) => {\r\n      const name = decodeURIComponent($1)\r\n      let val = decodeURIComponent($2)\r\n      val = String(val)\r\n      obj[name] = val\r\n      return rs\r\n    })\r\n    return obj\r\n  }\r\n\r\n  /**\r\n   * ajax请求\r\n   * @param {String} url 请求地址\r\n   * @param {Object} data 参数\r\n   * @param {String} type 类型\r\n   */\r\n  function request({\r\n    url,\r\n    data,\r\n    type\r\n  }) {\r\n    var token = getToken()\r\n    return $.ajax({\r\n      url: url,\r\n      type: type,\r\n      data: JSON.stringify(data),\r\n      contentType: \"application/json;charset=utf-8\",\r\n      beforeSend: res => {\r\n        if (token) {\r\n          res.setRequestHeader(\"Authorization\", token);\r\n        }\r\n      },\r\n      dataType: 'json'\r\n    })\r\n  }\r\n\r\n  //输入检查\r\n  var inputCheck = {\r\n    //登录前检查 若验证通过，返回username,psd\r\n    'loginCheck': function (usernameDom, psdDom) {\r\n      let username = $.trim($(usernameDom).val())\r\n      let psd = $(psdDom).val()\r\n      if (!username) {\r\n        $(usernameDom).siblings('.errmsg').html('用户名不能为空')\r\n      }\r\n      if (!psd) {\r\n        $(psdDom).siblings('.errmsg').html('密码不能为空')\r\n      }\r\n      if (!username || !psd) {\r\n        return false\r\n      } else {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      }\r\n    },\r\n    //注册前检查 若验证通过，返回username,psd\r\n    'regCheck': function () {\r\n      var username = $('#regUserName').val()\r\n      var psd = $('#regPsd').val()\r\n      var namecheck = /^[a-zA-Z0-9_-]{4,16}$/\r\n      var psdcheck = /^.*(?=.{6,})(?=.*\\d)(?=.*[a-z]).*$/\r\n      var a = namecheck.test($.trim(username))\r\n      var b = psdcheck.test(psd)\r\n      var c = psd === $('#confirmPsd').val()\r\n      if (!a) {\r\n        $('#regnameErr').html('由4-16位大小写字母，数字，下划线组合')\r\n      }\r\n      if (!b) {\r\n        $('#regpsdErr').html('请输入大于6位，且同时包含字母和数字')\r\n      }\r\n      if (!c) {\r\n        $('#regconfirmpsdErr').html('两次密码不一致')\r\n      }\r\n      if (a && b && c) {\r\n        return {\r\n          username,\r\n          psd\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n    //绑定手机检查 若验证通过，参数分别是手机号dom和验证码dom，返回phone,code\r\n    'smsCheck': function (phoneDom, codeDom) {\r\n      var phone = $(phoneDom).val()\r\n      var code = $(codeDom).val()\r\n      var a = /^1[34578]\\d{9}$/.test(phone)\r\n      var b = /^\\d{4}$/.test(code)\r\n      if (!a) {\r\n        $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      }\r\n      if (!b) {\r\n        $(codeDom).siblings('.errmsg').html('验证码格式不正确')\r\n      }\r\n      if (a && b) {\r\n        return {\r\n          phone,\r\n          code\r\n        }\r\n      } else {\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  //清除错误信息\r\n  function clearErrmsg() {\r\n    $('.errmsg').html('')\r\n  }\r\n\r\n  //设置token\r\n  function setToken(token) {\r\n    var time = new Date()\r\n    time.setTime(time.getTime()+60*1000)\r\n    CookieUtil.set('hwUserToken',token,time)\r\n    // window.sessionStorage.setItem('hwUserToken', token)\r\n  }\r\n  //获取token\r\n  function getToken() {\r\n    return CookieUtil.get('hwUserToken')\r\n    // return window.sessionStorage.getItem('hwUserToken')\r\n  }\r\n\r\n  //设置用户基本信息userid,username,avatar,roletype\r\n  function setUserData(res) {    \r\n    // window.sessionStorage.setItem('hwUserId', res.id)\r\n    // window.sessionStorage.setItem('hwUserName', res.name)    \r\n    // window.sessionStorage.setItem('hwUserAvatar', res.avatar)\r\n    // window.sessionStorage.setItem('hwuserRole', JSON.stringify(res.role))\r\n    CookieUtil.set('hwUserData',JSON.stringify(res))\r\n  }\r\n\r\n  //发送验证码等待时间\r\n  function stopsend(ele) {\r\n    $(ele).attr('disabled', \"true\")\r\n    var time = 60\r\n    var timer = setInterval(function () {\r\n      if (time-- == 1) {\r\n        $(ele).removeAttr(\"disabled\")\r\n        clearInterval(timer)\r\n      }\r\n      $(ele).html(time == 0 ? '获取验证码' : time + 's')\r\n    }, 1000)\r\n  }\r\n\r\n  //登录\r\n  function userlogin() {\r\n    clearErrmsg()\r\n    let config = inputCheck.loginCheck('#loginUserName', '#loginPsd')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/login/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          type: 2\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#loginErr').html(res.message)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          // location.href=\"/@/index.html\";\r\n        }\r\n      }).fail(function (err) {\r\n        console.log(err)\r\n      })\r\n    }\r\n  }\r\n  //注册\r\n  function userRegist() {\r\n    clearErrmsg()\r\n    var config = inputCheck.regCheck()\r\n    var role = $(\"[name='userrole']\").filter(\":checked\").val()\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/register/`,\r\n        data: {\r\n          username: config.username,\r\n          password: config.psd,\r\n          role: parseInt(role)\r\n        },\r\n        type: 'POST'\r\n      }).done(res => {\r\n        $('#regErr').html(res.message)\r\n        console.log(res)\r\n        if (res.code === 0) {\r\n          setToken(res.data.token)\r\n          setUserData(res.data)\r\n          $('.bindPhone').addClass('on').siblings('div').removeClass('on')\r\n        }\r\n      })\r\n    }\r\n  }\r\n  //发送验证码\r\n  function sendSMS(phoneDom, type, dom) {\r\n    clearErrmsg()\r\n    var phone = $(phoneDom).val()\r\n    var a = /^1[34578]\\d{9}$/.test(phone)\r\n    if (!a) {\r\n      $(phoneDom).siblings('.errmsg').html('手机号码格式不正确')\r\n      return\r\n    } else {\r\n      request({\r\n        url: `${SERVER}/users/sms/`,\r\n        data: {\r\n          phone_number: phone,\r\n          type\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        stopsend(dom)\r\n        dom.data('serialNumber', res.data.serial_number)\r\n      })\r\n    }\r\n  }\r\n  //手机绑定\r\n  function phoneBind() {\r\n    clearErrmsg()\r\n    var number = $('#sendBindMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#bindphoneNum', '#verifyCode')\r\n    if (config) {\r\n      request({\r\n        url: `${SERVER}/users/phone/binding/`,\r\n        data: {\r\n          phone_number: config.phone,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          type: 6\r\n        },\r\n        type: 'POST',\r\n      }).done(res => {\r\n        console.log(res)\r\n        $('#bindmsg').html(res.message)\r\n      })\r\n    }\r\n  }\r\n  //密码重置\r\n  function resetPsd() {\r\n    clearErrmsg()\r\n    var number = $('#sendResetPsdMsg').data('serialNumber')\r\n    var config = inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode')\r\n    var config2 = inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')\r\n    if (config && config2) {\r\n      request({\r\n        url: `${SERVER}/users/password/`,\r\n        data: {\r\n          username: config2.username,\r\n          password: config2.psd,\r\n          verify_code: config.code,\r\n          serial_number: number,\r\n          sms_type: 4,\r\n        },\r\n        type: 'put'\r\n      }).done(res => {\r\n        console.log(1, res)\r\n      })\r\n    }\r\n  }\r\n  //登录注册找回密码，步骤切换\r\n  function switchStep(source, target) {\r\n    $(source).on('click', function () {\r\n      $(target).addClass('on').siblings('div').removeClass('on')\r\n    })\r\n  }\r\n\r\n  switchStep('#toRegister', '.chooseRole')\r\n  switchStep('#tologin', '.loginForm')\r\n  switchStep('.chooseRole label', '.userRegister')\r\n  switchStep('#forgetpsd a', '.resetpsd')\r\n\r\n\r\n  $('#loginbtn').on('click', function () {\r\n    userlogin()\r\n  })\r\n  $('#nextstep').on('click', function () {\r\n    userRegist()\r\n  })\r\n  $('#complete').on('click', function () {\r\n    phoneBind()\r\n  })\r\n  $('#resetPsd').on('click', function () {\r\n    resetPsd()\r\n  })\r\n  $('#sendBindMsg').on('click', function () {\r\n    sendSMS('#bindphoneNum', 6, $(this))\r\n  })\r\n  $('#sendResetPsdMsg').on('click', function () {\r\n    sendSMS('#resetPsdPhone', 4, $(this))\r\n  })\r\n\r\n  //登录时暂时没啥用的切换\r\n  $('.loginForm>div').on('click', 'span', function () {\r\n    $(this).addClass('on').siblings().removeClass('on')\r\n  })\r\n\r\n  //按钮置灰\r\n  $('.form-item').on('keyup', 'input', function () {\r\n    clearErrmsg()\r\n    var father = $(this).parents('.form-item')\r\n    var type = father.data('type')\r\n    switch (type) {\r\n      case 'loginForm':\r\n        if (inputCheck['loginCheck']('#loginUserName', '#loginPsd')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break\r\n      case 'userRegister':\r\n        if (inputCheck['regCheck']()) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n      case 'bindPhone':\r\n        if (inputCheck['smsCheck']('#bindphoneNum', '#verifyCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        break;\r\n        case 'resetpsd':\r\n        if (inputCheck.smsCheck('#resetPsdPhone', '#resetPsdverifyCode')&&inputCheck.loginCheck('#resetPsdName', '#resetPsdCode')) {\r\n          father.find('input:submit').addClass('prepared')\r\n        } else {\r\n          father.find('input:submit').removeClass('prepared')\r\n        }\r\n        return;        \r\n    }\r\n\r\n\r\n  })\r\n  //图片微交互\r\n  function shakeAnimation(dom) {\r\n    $(dom).mouseenter(function () {\r\n      var thisPX = $(this).offset().left;\r\n      var thisPY = $(this).offset().top;\r\n      var boxWidth = $(this).outerWidth();\r\n      var boxHeight = $(this).outerHeight();\r\n      $(this).mousemove(function (event) {\r\n        var mouseX = event.pageX - thisPX;\r\n        var mouseY = event.pageY - thisPY;\r\n        var X;\r\n        var Y;\r\n        if (mouseX > boxWidth / 2) {\r\n          X = mouseX - boxWidth / 2;\r\n        } else {\r\n          X = mouseX - boxWidth / 2;\r\n        }\r\n        if (mouseY > boxHeight / 2) {\r\n          Y = boxHeight / 2 - mouseY;\r\n        } else {\r\n          Y = boxHeight / 2 - mouseY;\r\n        }\r\n\r\n        $(this).find('img').each((i, v) => {\r\n          var s = i % 2 === 0 ? (10 + 10 * i) : (10 + 10 * i)\r\n          $(v).css({\r\n            \"transform\": \"translateY(\" + X / s + \"px) \" + \"translateX(\" + Y / s + \"px) \"\r\n          })\r\n        })\r\n\r\n        // $(this).css({\r\n        //   \"transform\": \"translateY(\"+X/20+\"px) \" +\"translateX(\"+Y/20+\"px) \"\r\n        // });\r\n\r\n      });\r\n    });\r\n    $(dom).mouseleave(function () {\r\n      $(this).css({\r\n        \"transform\": \"rotateY(0deg) rotateX(0deg)\"\r\n      });\r\n    });\r\n  }\r\n  shakeAnimation('.imgbox')\r\n})"]}
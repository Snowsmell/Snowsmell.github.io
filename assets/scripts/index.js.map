{"version":3,"sources":["scripts/index.js"],"names":["$","UA","userAgent","navigator","test","match","toLowerCase","indexOf","dom","IETester","css","on","css3","anchors","menu","afterLoad","anchorLink","index","setTimeout","addClass","Counter","find","each","i","v","duration","easing","step","this","text","x","f","parseFloat","isNaN","s","Math","round","toString","rs","length","toDecimal","now","ceil","hasClass","toChange","onLeave","direction","left","eq","siblings","removeClass","dataType","data","type","res","count","page","results","forEach","image_url","clipimg","getnews","summary","substr","a","created_time","replace","id","html","done","window","width","container","document","getElementById","setUlWidth","lis","ul","querySelectorAll","liWidth","offsetWidth","cloneLi","cloneNode","appendChild","call","style","setInterval","animate","marginLeft","carousel","parentNode","X","Y","thisPX","offset","thisPY","top","boxHeight","outerHeight","mouseX","event","pageX","mouseY","pageY","clearTimeout","timer","transform","mouseleave"],"mappings":"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","file":"index.js","sourcesContent":["\r\n$(function () {\r\n  function IETester(userAgent){\r\n    var UA =  userAgent || navigator.userAgent;\r\n    if(/msie/i.test(UA)){\r\n        return UA.match(/msie (\\d+\\.\\d+)/i)[1];\r\n    }else if(~UA.toLowerCase().indexOf('trident') && ~UA.indexOf('rv')){\r\n        return UA.match(/rv:(\\d+\\.\\d+)/)[1];\r\n    }\r\n    return false;\r\n  }\r\n  if(IETester()&&IETester()<10){\r\n    $('*').css('opacity','1')\r\n  }\r\n\r\n  //首屏进来的加载前\r\n\r\n  $('#starcloud').on('load',function(){\r\n    $('#modal').remove()\r\n  })\r\n  \r\n\r\n\r\n  $('#fullpage').fullpage({\r\n    css3: true,\r\n    anchors: ['homepage', 'energysave', 'innovation', 'partner', 'news'],\r\n    menu: \".menu\",\r\n    afterLoad: function (anchorLink, index) {\r\n      //首屏幕的动画\r\n      if (!$('.homepage').hasClass('on')) {\r\n        setTimeout(function () {\r\n          $('.homepage').addClass('on')\r\n        }, 2000)\r\n      }\r\n      toChange(index)\r\n    },\r\n    onLeave: function (index, direction) {\r\n      // console.log('离开', index, direction)\r\n    }\r\n  });\r\n\r\n  function toDecimal(x) {\r\n    var f = parseFloat(x);\r\n    if (isNaN(f)) {\r\n      return false;\r\n    }\r\n    var f = Math.round(x * 10) / 10;\r\n    var s = f.toString();\r\n    var rs = s.indexOf('.');\r\n    if (rs < 0) {\r\n      rs = s.length;\r\n    }\r\n    return s;\r\n  }\r\n  //每屏首次加载后执行的函数\r\n  function toChange(index) {\r\n    switch (index) {\r\n      case 2:\r\n        if (!$('.energysave').hasClass('on')) {\r\n          $('.energysave')\r\n            .addClass('on')\r\n            .find('li b').each(function (i, v) {\r\n              $(this).prop('Counter', 0).animate({\r\n                Counter: $(this).text()\r\n              }, {\r\n                duration: 2000,\r\n                easing: 'swing',\r\n                step: i == 2 ? function (now) {\r\n                  $(this).text(toDecimal(now));\r\n                } : function (now) {\r\n                  $(this).text(Math.ceil(now));\r\n                }\r\n              });\r\n            });\r\n        }\r\n        break;\r\n      case 3:\r\n        if (!$('.innovation').hasClass('on')) {\r\n          $('.innovation').addClass('on')\r\n        }\r\n        break;\r\n      case 4:\r\n        if (!$('.partner').hasClass('on')) {\r\n          $('.partner').addClass('on')\r\n        }\r\n        break;\r\n      case 5:\r\n        if (!$('.news').hasClass('on')) {\r\n          $('.news').addClass('on')\r\n        }\r\n        break;\r\n    }\r\n  }\r\n  //创新科技四个气泡框选择\r\n  $('#fourbubble').on('click', 'li', function () {\r\n    var index = $(this).index()\r\n    $('#fourcontent span').animate({\r\n      'left': 12.5 + 25 * index + '%'\r\n    }, 100)\r\n    $('#fourcontent p').eq(index).addClass('on').siblings('p').removeClass('on')\r\n  })\r\n  //新闻列表,设置轮播\r\n  function getnews() { \r\n    $.ajax({\r\n      url: 'http://test.oms.hwariot.com/api/v1/news/?page_size=4',\r\n      type: 'GET',\r\n      dataType: \"json\",\r\n      data: {},\r\n    }).done(function(res){\r\n      if (res.count > 0) {\r\n        var page = '';\r\n        res.results.forEach(function(v, i){\r\n          var a = v.summary.length > 40 ? \"...\" : \"\";\r\n          page += \r\n          '<li>'+\r\n            '<div class=\"imgbox\">'+\r\n              '<div>'+\r\n              '<img src='+v.image_url+'>'+\r\n              '<a href=\"/@/newsdetail.html?id='+v.id+'\"></a>'+                \r\n              '</div>'+\r\n            '</div>'+\r\n            '<h3>'+v.title+'</h3>'+\r\n            '<p>'+v.summary.substr(0, 40)+a+'</p>'+\r\n            '<div>'+\r\n              '<span class=\"date\">'+v.created_time.replace('T','&nbsp;&nbsp;')+'</span>'+\r\n              '<a href=\"/@/newsdetail.html?id='+v.id+'\">详情 >></a>'+\r\n            '</div>'+\r\n          '</li>'\r\n        })\r\n        $('#newslist ul').html(page)\r\n\r\n      }\r\n    }).done(function(res){\r\n      if ($(window).width() > 768) {\r\n        carousel()\r\n      }\r\n      clipimg()\r\n    })\r\n  }\r\n  getnews()\r\n\r\n  //新闻列表轮播图\r\n  function carousel() {\r\n    var container = document.getElementById('newslist')\r\n    var ul = container.querySelector('ul');\r\n    var lis = ul.querySelectorAll('li');\r\n    var timer = null;\r\n    var index = 1;\r\n    var containerWidth = container.offsetWidth;\r\n    var liWidth = lis[0].offsetWidth;\r\n\r\n    for (var i = 0; i < 2; i++) {\r\n      var cloneLi = lis[i].cloneNode(true);\r\n      ul.appendChild(cloneLi)\r\n    }\r\n\r\n    function setUlWidth() {\r\n      [].forEach.call(ul.querySelectorAll('li'), function (v, i) {\r\n        v.style.width = liWidth + 'px';\r\n        ul.style.width = liWidth * 6 + 'px' //这里可以优化下性能，不过不是重点\r\n      })\r\n    }\r\n    setUlWidth();\r\n\r\n    timer = setInterval(function () {\r\n      $(ul).animate({\r\n        'marginLeft': -liWidth * index++\r\n      }, 500)\r\n      if (index === 5) {\r\n        $(ul).css({\r\n          'marginLeft': 0\r\n        })\r\n        index = 1\r\n      }\r\n    }, 8000)\r\n  }\r\n  //裁剪图片\r\n  function clipimg() {\r\n    $('#newslist img').each(function (i, v) {\r\n      $(v.parentNode).css({\r\n        'height': $(v).width() * 0.66\r\n      })\r\n    })\r\n  }\r\n\r\n  //图片微交互\r\n  function shakeAnimation(dom) {\r\n    $(dom).mouseenter(function () {\r\n      var thisPX = $(this).offset().left;\r\n      var thisPY = $(this).offset().top;\r\n      var boxWidth = $(this).outerWidth();\r\n      var boxHeight = $(this).outerHeight();\r\n      $(this).mousemove(function (event) {\r\n        var mouseX = event.pageX - thisPX;\r\n        var mouseY = event.pageY - thisPY;\r\n        var X;\r\n        var Y;\r\n        if (mouseX > boxWidth / 2) {\r\n          X = mouseX - boxWidth / 2;\r\n        } else {\r\n          X = mouseX - boxWidth / 2;\r\n        }\r\n        if (mouseY > boxHeight / 2) {\r\n          Y = boxHeight / 2 - mouseY;\r\n        } else {\r\n          Y = boxHeight / 2 - mouseY;\r\n        }\r\n\r\n        $(this).find('img').each((i, v) => {\r\n          var s = i % 2 === 0 ? (10 + 10 * i) : (10 + 10 * i)\r\n          $(v).css({\r\n            \"transform\": \"translateY(\" + X / s + \"px) \" + \"translateX(\" + Y / s + \"px) \"\r\n          })\r\n        })\r\n      });\r\n    });\r\n    $(dom).mouseleave(function () {\r\n      $(this).css({\r\n        // \"transform\": \"rotateY(0deg) rotateX(0deg)\"\r\n      });\r\n    });\r\n  }\r\n  shakeAnimation('aside')\r\n\r\n  //resize\r\n  var timer = null;\r\n  $(window).on('resize', function () {\r\n    clearTimeout(timer)\r\n    timer = setTimeout(function () {\r\n      // location.reload()\r\n    }, 300)\r\n\r\n  })\r\n});\r\n\r\n"]}